"use strict";(self.webpackChunkodps_sdk_doc=self.webpackChunkodps_sdk_doc||[]).push([[4614],{1146:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var i=t(5893),s=t(1151);const o={title:"\u5bf9 Tunnel \u64cd\u4f5c\u6253\u6807",sidebar_position:1},r=void 0,a={id:"operations/tunnel-tags",title:"\u5bf9 Tunnel \u64cd\u4f5c\u6253\u6807",description:"\u5728\u8d44\u6e90\u89c2\u6d4b\u573a\u666f\u4e0b\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u5bf9 Tunnel \u64cd\u4f5c\u6253\u6807\u7684\u9700\u6c42\uff0c\u7528\u6765\u540e\u7eed\u7edf\u8ba1 Tunnel \u64cd\u4f5c\u7684\u6570\u91cf\u548c\u76f8\u5173\u4fe1\u606f\u3002\u672c\u6587\u6863\u4ecb\u7ecd\u5982\u4f55\u5bf9",source:"@site/docs/operations/tunnel-tags.md",sourceDirName:"operations",slug:"/operations/tunnel-tags",permalink:"/operations/tunnel-tags",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"\u5bf9 Tunnel \u64cd\u4f5c\u6253\u6807",sidebar_position:1},sidebar:"docs",previous:{title:"\u9644\u52a0\u529f\u80fd",permalink:"/category/\u9644\u52a0\u529f\u80fd"},next:{title:"\u66f4\u65b0\u65e5\u5fd7",permalink:"/changelog"}},l={},c=[{value:"\u6253\u6807\u65b9\u5f0f",id:"\u6253\u6807\u65b9\u5f0f",level:2},{value:"Tunnel \u76f8\u5173\u64cd\u4f5c",id:"tunnel-\u76f8\u5173\u64cd\u4f5c",level:3},{value:"\u5f00\u653e\u5b58\u50a8\u76f8\u5173\u64cd\u4f5c",id:"\u5f00\u653e\u5b58\u50a8\u76f8\u5173\u64cd\u4f5c",level:3},{value:"\u89c2\u6d4b\u65b9\u5f0f",id:"\u89c2\u6d4b\u65b9\u5f0f",level:2}];function d(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",...(0,s.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e.p,{children:["\u5728",(0,i.jsx)(e.strong,{children:"\u8d44\u6e90\u89c2\u6d4b"}),"\u573a\u666f\u4e0b\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u5bf9 Tunnel \u64cd\u4f5c\u6253\u6807\u7684\u9700\u6c42\uff0c\u7528\u6765\u540e\u7eed\u7edf\u8ba1 Tunnel \u64cd\u4f5c\u7684\u6570\u91cf\u548c\u76f8\u5173\u4fe1\u606f\u3002\u672c\u6587\u6863\u4ecb\u7ecd\u5982\u4f55\u5bf9\nTunnel \u64cd\u4f5c\u6253\u6807\u3002"]}),"\n",(0,i.jsx)(e.h2,{id:"\u6253\u6807\u65b9\u5f0f",children:"\u6253\u6807\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.h3,{id:"tunnel-\u76f8\u5173\u64cd\u4f5c",children:"Tunnel \u76f8\u5173\u64cd\u4f5c"}),"\n",(0,i.jsxs)(e.p,{children:["\u5bf9\u4e8e Tunnel\n\u76f8\u5173\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u914d\u7f6e\u7684\u6807\u8bb0\uff08Tags\uff09\u914d\u7f6e\u5728 ",(0,i.jsx)(e.a,{href:"/api-reference/tunnel/Configuration",children:"Configuration"}),"\n\u7c7b\u4e2d\u3002\nConfiguration \u7c7b\u63d0\u4f9b\u4e86 ",(0,i.jsx)(e.a,{href:"/api-reference/tunnel/Configuration#%E8%AE%BE%E7%BD%AE%E6%A0%87%E7%AD%BE%E5%88%97%E8%A1%A8",children:"withTags"}),"\n\u65b9\u6cd5\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u914d\u7f6e\u7684\u6807\u8bb0\uff08Tags\uff09\u914d\u7f6e\u5728 Configuration \u7c7b\u4e2d\u3002"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u793a\u4f8b"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// ingore imports\n\npublic class TagsTest {\n\n  private static final String ENDPOINT;\n  private static final String ACCESS_ID;\n  private static final String ACCESS_KEY;\n  private static final String PROJECT;\n\n  public static void main(String[] args) throws TunnelException, IOException {\n    Account account = new AliyunAccount(ACCESS_ID, ACCESS_KEY);\n    Odps odps = new Odps(account);\n    odps.setEndpoint(ENDPOINT);\n    odps.setDefaultProject(PROJECT);\n\n    Configuration configuration =\n        Configuration.builder(odps).withTags(ImmutableList.of("test_tag")).build();\n    TableTunnel.DownloadSession\n        downloadSession =\n        odps.tableTunnel(configuration).buildDownloadSession(odps.getDefaultProject(), "testtable")\n            .build();\n    long recordCount = downloadSession.getRecordCount();\n    TunnelRecordReader recordReader = downloadSession.openRecordReader(0, recordCount);\n    recordReader.forEach(record -> {\n      System.out.println(record);\n    });\n  }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u5f00\u653e\u5b58\u50a8\u76f8\u5173\u64cd\u4f5c",children:"\u5f00\u653e\u5b58\u50a8\u76f8\u5173\u64cd\u4f5c"}),"\n",(0,i.jsx)(e.p,{children:"\u5bf9\u4e8e Tunnel\n\u76f8\u5173\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u914d\u7f6e\u7684\u6807\u8bb0\uff08Tags\uff09\u914d\u7f6e\u5728 EnvironmentSettings \u7c7b\u4e2d\u3002\nEnvironmentSettings.Builder \u540c\u6837\u63d0\u4f9b\u4e86 [withTags] \u65b9\u6cd5\uff0c\u53ef\u4ee5\u5c06\u9700\u8981\u914d\u7f6e\u7684\u6807\u8bb0\uff08Tags\uff09\u914d\u7f6e\u5728 EnvironmentSettings \u7c7b\u4e2d\u3002"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u4f7f\u7528\u793a\u4f8b"}),"\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// ingore imports\n\npublic class Main {\n\n  private static final String ENDPOINT;\n  private static final String ACCESS_ID;\n  private static final String ACCESS_KEY;\n  private static final String PROJECT;\n\n  public static void main(String[] args) throws IOException {\n    Account account = new AliyunAccount(ACCESS_ID, ACCESS_KEY);\n    Credentials\n        credentials = Credentials.newBuilder().withAccount(account)\n        .build();\n\n    EnvironmentSettings settings =\n        EnvironmentSettings.newBuilder().withCredentials(credentials)\n            .withServiceEndpoint(ENDPOINT)\n            .withTags(ImmutableList.of("test_tag"))\n            .build();\n    \n    TableReadSessionBuilder builder = new TableReadSessionBuilder();\n    TableBatchReadSession\n        session =\n        builder.withSettings(settings)\n            .identifier(TableIdentifier.of(PROJECT, "tableName"))\n            .buildBatchReadSession();\n    InputSplitAssigner inputSplitAssigner = session.getInputSplitAssigner();\n    InputSplit[] allSplits = inputSplitAssigner.getAllSplits();\n    for (InputSplit split : allSplits) {\n      SplitReader<VectorSchemaRoot>\n          arrowReader =\n          session.createArrowReader(split,\n                                    ReaderOptions.newBuilder().withSettings(settings).build());\n\n      while (arrowReader.hasNext()) {\n        VectorSchemaRoot vectorSchemaRoot = arrowReader.get();\n        System.out.println(vectorSchemaRoot.contentToTSVString());\n      }\n      arrowReader.close();\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u89c2\u6d4b\u65b9\u5f0f",children:"\u89c2\u6d4b\u65b9\u5f0f"}),"\n",(0,i.jsxs)(e.p,{children:["\u5bf9\u4e8e Tunnel Tags \u7684\u64cd\u4f5c\u8bb0\u5f55\uff0c\u7ecf\u8fc7\u7ea6 5 \u5206\u949f\u5de6\u53f3\u7684\u5904\u7406\uff0c\n\u5c06\u88ab\u4fdd\u5b58\u5728 ",(0,i.jsx)(e.a,{href:"https://help.aliyun.com/zh/maxcompute/user-guide/tenant-level-information-schema",children:"Information Schema"}),"\n\u4e2d\u7684 tunnels_history \u8868\u4e2d\u3002"]}),"\n",(0,i.jsx)(e.p,{children:"\u53ef\u4ee5\u901a\u8fc7\u4e0b\u8ff0 SQL \u67e5\u8be2\u7ecf\u8fc7\u6253\u6807\u7684\u64cd\u4f5c\u8bb0\u5f55"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:'set odps.namespace.schema = true;\nselect * from  SYSTEM_CATALOG.INFORMATION_SCHEMA.TUNNELS_HISTORY where app_tags="test_tag";\n'})}),"\n",(0,i.jsxs)(e.admonition,{type:"info",children:[(0,i.jsx)(e.mdxAdmonitionTitle,{}),(0,i.jsx)(e.p,{children:"\u5b58\u5728\u8868 tunnels_history \u4e2d\u6ca1\u6709 app_tags \u5b57\u6bb5\u7684\u573a\u666f\uff0c\u662f\u56e0\u4e3a\u8be5\u529f\u80fd\u5728\u60a8\u6240\u5728\u7684\u533a\u57df\u8fd8\u672a\u5f00\u901a\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u3002"})]})]})}function u(n={}){const{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},1151:(n,e,t)=>{t.d(e,{Z:()=>a,a:()=>r});var i=t(7294);const s={},o=i.createContext(s);function r(n){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);